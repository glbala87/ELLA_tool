# ELLA Testdata

The data used during development and testing is stored in <https://gitlab.com/alleles/ella-testdata.git>.
The scripts stored here are used for downloading that data, creating new datasets based on database
state and easily switching between datasets.

## Standard datasets

The main datasets are `default` and `e2e`. As might be expected, `default` is the general purpose
dataset and `e2e` is used while running the end-to-end tests.

## Custom datasets

When writing a new feature or new tests, it may be useful to easily reset the database to a specific
state that is not either of the standard datasets. This can be done from within the container via
[ops/testdata/reset-testdata.py](reset-testdata.py) or remotely via the testdata API.

Some example commands:

```bash
# reset to the default dataset
./ops/testdata/reset-testdata.py
./ops/testdata/reset-testdata.py reset
curl -XPOST http://$CONTAINER_IP:23232/database/reset

# create a new dataset
./ops/testdata/reset-testdata.py dump --testset my_dataset
curl -d testset=my_dataset http://$CONTAINER_IP:23232/database/dump

# reset to a specific dataset
./ops/testdata/reset-testdata.py reset --testset default
./ops/testdata/reset-testdata.py reset --testset e2e
./ops/testdata/reset-testdata.py reset --testset my_dataset
curl -d testset=default http://$CONTAINER_IP:23232/database/reset
curl -d testset=e2e http://$CONTAINER_IP:23232/database/reset
curl -d testset=my_dataset http://$CONTAINER_IP:23232/database/reset
```

For more details, check the help info generated by the relevant scripts.
